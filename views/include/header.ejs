<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <link rel="stylesheet" href="/public/css/main.min.css">
    <link rel="stylesheet" href="/public/css/color.css">
    <link rel="stylesheet" href="/public/css/style.css">
    <link rel="stylesheet" href="/public/css/responsive.css">
</head>

<body>
    <% months=["January","February","March","April","May","June","July", "August"
        ,"September","October","November","December"];%>
        <div class="them-layout">
            <div class="topbar stick">
                <div class="logo">
                    <a href="/">
                        <img src="/public/img/logo.png" alt="">
                    </a>
                </div>
                <div class="top-area">
                    <ul class="main-menu" id="main-menu">

                    </ul>
                    <ul class="setting-area">

                    </ul>
                </div>

            </div>
            <script>
                var mainUrl = 'http://localhost:3000';
                var months = ["January", "February", "March", "April", "May", "June", "July",
                    "August", "September", "October", "November", "December"];
                function loadLikesfunction(data) {
                    var isLiked = false;

                    for (var i = 0; i < data.likers.length; i++) {
                        var likers = data.likers[i];
                        if (likers._id == window.user._id) {
                            isLiked = true;
                            break;
                        }

                    }

                    var html = '';

                    html += '<div class"we-video-info>';
                    html += '<ul>';
                    html += '<li>';
                    var className = '';
                    if (isLiked) {
                        className = 'like';
                    } else {
                        className = 'none';
                    }
                    html += '<span class="' + className + '" onclick="toggleLikePost(this)" data-id="' + data._id + '"> ';
                    html += '<i class="ti-thumb-up"></i>';
                    html += '<ins>' + data.likers.length + '</ins>';
                    html += '</span>';
                    html += '</li>';

                    html += '<li>';
                    html += '<span class="comment" title="Comments">';
                    html += '<i class="fa fa-comments-o"></i>';
                    html += '<ins>' + data.comments.length + ' </ins>';

                    html += '</span>';
                    html += '</li>';
                    html += '<li>';
                    html += '<span class="share" onclick="sharePost(this)" data-id="' + data._id + '">';
                    html += '<i class="ti-share"></i>';
                    html += '<ins>' + data.shares.length + '</ins>';
                    html += '</span>';
                    html += '</li>';
                    html += '</ul>';
                    html += '</div>';
                    return html
                }
                function showAddPost() {
                    if (localStorage.getItem('accessToken')) {

                        var html = '';
                        html += '<div class="central-meta">';
                        html += '<div class="new-postbox">';
                        html += '<figure>';
                        html += '<img src="' + mainUrl + '/' + window.user.profileImage + '">';
                        html += '</figure>';
                        html += '<div class="newpst-input">';
                        html += '<form method="post" id="form-add-post" onsubmit="return doPost(this)">';
                        html += '<input type="hidden" value="post" name="type">';
                        html += '<textarea name="caption" placeholder="write something" rows="2"></textarea>';
                        html += '<div class="attachments">';
                        html += '<ul>';
                        html += '<li>'
                        html += '<img id="post-img-preview" style="display:none;">';
                        html += '</li>';
                        html += '<li>'

                        html += '<video id="post-video-preview" controls style=" display:none" > </video>';
                        html += '</li>';
                        html += '<li>';
                        html += '<i class="fa fa-image"></i>';
                        html += '<lable class="fileContainer">';
                        html += '<input type="file" accept="image/*" name="image" onchange="previewImagePost(this)">';
                        html += '</lable">';
                        html += '</li>';
                        html += '<li>';
                        html += '<i class="fa fa-video-camera"></i>';
                        html += '<lable class="fileContainer">';
                        html += '<input type="file" accept="video/*" name="video" onchange="previewVideoPost(this)">';
                        html += '</lable">';

                        html += '</li>';
                        html += '<li>';
                        html += '<button type="submit">Post<button>';
                        html += '</li>';
                        html += '</ul>';
                        html += '</form>';
                        html += '</div>';
                        html += '</div>';
                        html += '</div>';




                        document.getElementById('add-post-box').innerHTML = html
                    }
                }
                function previewImagePost(self) {
                    var file = self.files
                    if (file.length > 0) {
                        var fileReader = new FileReader();
                        fileReader.onload = function (event) {
                            document.getElementById('post-img-preview').style.display = '',
                                document.getElementById('post-img-preview').setAttribute('src', event.target.result);
                        }
                        fileReader.readAsDataURL(file[0])
                    }

                }
                function previewVideoPost(self) {
                    var file = self.files;

                    if (file.length > 0) {
                        var fileReader = new FileReader();
                        fileReader.onload = function (event) {
                            document.getElementById('post-video-preview').style.display = '',
                                document.getElementById('post-video-preview').setAttribute('src', event.target.result);
                        }

                        fileReader.readAsDataURL(file[0])
                    }
                }



            </script>
            <style>
                #post-img-preview,
                #post-video-preview {
                    height: 300px;
                    width: 300px;
                    object-fit: cover;

                }
            </style>